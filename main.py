import os
import matplotlib.pyplot as plt
import tensorflow as tf
import pathlib

data_dir = './dataset/malevis_train_val_224x224/gyu_train/'

data_dir = pathlib.Path(data_dir)
print(data_dir)

train_ds = tf.keras.utils.image_dataset_from_directory(
    data_dir,
    validation_split=0.2,
    subset="training",
    seed=1,
    image_size=(224, 224),
    batch_size=64)

print(train_ds)
class_names = train_ds.class_names
print(class_names)

for images, labels in train_ds.take(1):
    print(labels.shape)
    print(labels)
    exit()